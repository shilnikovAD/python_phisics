# М10Б: Ферромагнетизм в «нейросетях»

## Задание

Исследовать систему взаимодействующих спинов на решетке:
- Энергия взаимодействия: **E = -∑ sᵢ·sⱼ** (по соседям)
- Метод Монте-Карло для моделирования равновесия
- Получить функцию намагниченности **⟨M⟩(T)**
- Определить экспериментально температуру фазового перехода **T₀**


## Физическая модель

### Гамильтониан

```
H = -J·∑⟨i,j⟩ sᵢ·sⱼ - B·∑ᵢ sᵢ
```

Где:
- **J** — обменное взаимодействие между соседями
- **B** — внешнее магнитное поле
- **∑⟨i,j⟩** — сумма по парам ближайших соседей

### Для ферромагнетика (J > 0):

- При **T < T_c**: спонтанная намагниченность, **⟨M⟩ ≠ 0**
- При **T = T_c**: критическая точка, фазовый переход
- При **T > T_c**: парамагнитная фаза, **⟨M⟩ ≈ 0**

### Теоретическое значение T_c:

Для 2D решетки Изинга (точное решение Онзагера):

```
kT_c / J = 2 / ln(1 + √2) ≈ 2.269
```

---

## Эксперименты М10Б

### Эксперимент 1: Наблюдение фазового перехода

**Параметры:**
- J = 1.0 (ферромагнетик)
- B = 0.0
- Размер = 30×30

**Действия:**
1. T = 0.5 → "Ферромагнетик" → Старт
   - Наблюдайте: спины выстраиваются, M → 1
2. T = 2.3 → Старт
   - Наблюдайте: критические флуктуации, M ≈ 0
3. T = 3.5 → Старт
   - Наблюдайте: хаотичное состояние, M ≈ 0

### Эксперимент 2: Автоматическое построение ⟨M⟩(T)

**Действия:**
1. Установите J = 1.0
2. Нажмите **"Построить ⟨M⟩(T)"**
3. Ждите ~30 секунд
4. Получите таблицу M(T) и χ(T)
5. Видно, где пик восприимчивости χ → это T_c!

**Результат:**
- Таблица с температурами, M и χ
- Указание на пик χ при T ≈ 2.2-2.4
- Сравнение с теорией

### Эксперимент 3: Определение T₀

**Действия:**
1. Установите J = 1.0
2. Нажмите **" Найти T₀ = T_c"**
3. Ждите ~40 секунд
4. Получите T_c экспериментальное

**Результат:**
```
Критическая температура T₀:
T_c = 2.397

Теория (2D Изинг): T_c = 2.269
Ошибка: 5.62%
```

---

## Алгоритм Метрополиса

### Шаги:

1. Выбрать случайный спин **(i, j)**
2. Вычислить изменение энергии **ΔE** при переворачивании:
   ```
   ΔE = 2·B·sᵢⱼ + 2·J·sᵢⱼ·(s_вверх + s_вниз + s_лево + s_право)
   ```
3. Принять переворот с вероятностью:
   ```
   P = min(1, exp(-ΔE/T))
   ```

### Почему это работает?

Алгоритм Метрополиса гарантирует сходимость к **распределению Больцмана**:
```
P(состояние) ∝ exp(-E/kT)
```

---

## Результаты тестов (test_m10b.py)

### Сканирование M(T):

```
T      ⟨|M|⟩    χ        ⟨E⟩/N
0.50   0.9484   0.72     -1.46
1.38   0.7973   0.42     -1.38
2.25   0.3674   0.35     -1.10  ← около T_c
3.12   0.1530   0.12     -0.71
4.00   0.0541   0.07     -0.58
```

### Определение T_c:

**Метод максимума χ:**
- T_c эксп. = 2.397
- T_c теория = 2.269
- Ошибка = 5.62%

**Хорошее совпадение!**

---